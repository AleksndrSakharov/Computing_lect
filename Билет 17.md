```
Формулы Ньютона-Котеса. Принцип построения (интерполяционный подход). Характеристика формул трапеций, Симпсона, правила «3/8» (узлы и веса).
```
**1. Общий принцип**
Идея: заменить подынтегральную функцию $f(x)$ на интерполяционный многочлен Лагранжа $P_n(x)$, построенный на равномерной сетке узлов, и проинтегрировать его точно.
$$I \approx \int_a^b P_n(x) dx = \int_a^b \sum_{k=0}^n y_k L_k(x) dx = \sum_{k=0}^n y_k \left( \int_a^b L_k(x) dx \right)$$
#Определение Величины $w_k = \int_a^b L_k(x) dx$ называются **весами** квадратурной формулы. Они не зависят от функции $f(x)$.

**2. Основные формулы (для элементарного отрезка)**
*   **Формула трапеций ($n=1$, 2 узла $a, b$):**
    Замена $f(x)$ на хорду (прямую).
    $\int_a^b f(x) dx \approx \frac{b-a}{2} (f(a) + f(b))$.
    Веса: $\frac{1}{2}, \frac{1}{2}$ (умноженные на длину отрезка).
*   **Формула Симпсона ($n=2$, 3 узла $a, \frac{a+b}{2}, b$):**
    Замена $f(x)$ на параболу.
    $\int_a^b f(x) dx \approx \frac{b-a}{6} \left( f(a) + 4f(\frac{a+b}{2}) + f(b) \right)$.
    Веса: $\frac{1}{6}, \frac{4}{6}, \frac{1}{6}$.
    *Примечание:* часто записывают через шаг $h = \frac{b-a}{2}$, тогда $I \approx \frac{h}{3}(f_0 + 4f_1 + f_2)$.
*   **Правило «3/8» ($n=3$, 4 узла):**
    $\int_a^b f(x) dx \approx \frac{b-a}{8} (f(a) + 3f(x_1) + 3f(x_2) + f(b))$.

**3. Составные формулы**
Формулы применяются к каждому подотрезку разбиения и суммируются.
Например, составная формула Симпсона:
$I \approx \frac{h}{3} [f(a) + f(b) + 4\sum f_{\text{нечет}} + 2\sum f_{\text{чет}}]$.

---

---
---
## Характеристика формул:

### 1. Формула трапеций:
- **Узлы:** $a, b$
- **Веса:** $w_0 = w_1 = 1/2$
- **Вид:** $\int_a^b f(x) dx \approx (b - a) \frac{f(a) + f(b)}{2}$
### 2. Формула Симпсона:
- **Узлы:** $a, \frac{a + b}{2}, b$
- **Веса:** $w_0 = 1/6, w_1 = 2/3, w_2 = 1/6$
- **Вид:** $\int_a^b f(x) dx \approx (b - a) \frac{f(a) + 4f(\frac{a + b}{2}) + f(b)}{6}$

### 3. Правило «3/8»:
- **Узлы:** $a, \frac{2a + b}{3}, \frac{a + 2b}{3}, b$
- **Веса:** $w_0 = 1/8, w_1 = 3/8, w_2 = 3/8, w_3 = 1/8$
- **Вид:** $\int_a^b f(x) dx \approx (b - a) \frac{f(a) + 3f(\frac{2a+b}{3}) + 3f(\frac{a+2b}{3}) + f(b)}{8}$
---

#Доказательство весов для формулы трапеций (вывод из интерполяционного подхода):

Для двух узлов $x_0 = a, \, x_1 = b$ базисные многочлены Лагранжа:
$$
c_0(x) = \frac{x - b}{a - b}, \quad c_1(x) = \frac{x - a}{b - a}.
$$

Веса вычисляются как:
$$
w_0 = \frac{1}{b - a} \int_a^b c_0(x) dx = \frac{1}{b - a} \int_a^b \frac{x - b}{a - b} dx = \frac{1}{(b - a)(a - b)} \left[ \frac{(x - b)^2}{2} \right]_a^b = \frac{1}{2}.
$$
$$
w_1 = \frac{1}{b - a} \int_a^b c_1(x) dx = \frac{1}{b - a} \int_a^b \frac{x - a}{b - a} dx = \frac{1}{(b - a)^2} \left[ \frac{(x - a)^2}{2} \right]_a^b = \frac{1}{2}.
$$
Следовательно, $I[f] = (b - a) \left( \frac{1}{2}f(a) + \frac{1}{2}f(b) \right) = (b - a) \frac{f(a) + f(b)}{2}.$

---

**Принцип построения (интерполяционный подход):**  
Формулы строятся на основе интегрирования интерполяционного многочлена Лагранжа на равномерной сетке узлов.