```
Кубические сплайны. Определение (условия гладкости C2)
```
**2. Кубический сплайн**
Сплайн $S(x)$ — это функция, которая на каждом отрезке $[x_i, x_{i+1}]$ является кубическим полиномом, а в узлах $x_i$ непрерывна сама функция, её первая и вторая производные ($S \in C^2$).
В узлах: $S(x_i) = y_i$.

Матрица системы — трехдиагональная. Решается методом прогонки.
*Граничные условия:* Часто полагают $M_0 = M_n = 0$ (естественный сплайн).

---
---
## 1. Определение.

Пусть на отрезке $[a, b]$ задана сетка узлов: $a = x_0 < x_1 < \cdots < x_n = b$.

Кубическим сплайном $S(x)$, интерполирующим функцию $f(x)$ на этой сетке, называется функция $S(x)$, удовлетворительная условиям:

1. **Интерполяция:**  $S(x_i) = f(x_i)$ для всех $i = 0, \ldots, n$.
2. **Гладкость $C^2$:**
   - $S(x) \in C^2[a, b]$ — функция дважды непрерывно дифференцируема на всём отрезке.
   - На каждом отрезке $[x_{i-1}, x_i]$ функция $S(x)$ является кубическим полиномом:$$
   S_i(x) = a_i + b_i(x - x_{i-1}) + c_i(x - x_{i-1})^2 + d_i(x - x_{i-1})^3,\quad x \in [x_{i-1}, x_i].$$
3. **Граничные условия** (одни из типов, например):
   - Естественные: $S''(x_0) = S''(x_n) = 0.$
   - С условиями на первые производные: $S'(x_0) = f'(x_0),\quad S'(x_n) = f'(x_n) \text{ и т.д}.$

## 2. Условия гладкости $C^2$ в явном виде.

На каждом внутреннем узле $x_i$ ($i = 1, \ldots, n - 1$) должны выполняться:

$$
\begin{cases}
S_i(x_i) = S_{i+1}(x_i), & (\text{непрерывность функции}) \\
S'_i(x_i) = S'_{i+1}(x_i), & (\text{непрерывность 1-й производной}) \\
S''_i(x_i) = S''_{i+1}(x_i), & (\text{непрерывность 2-й производной})
\end{cases}
$$

Это обеспечивает глобальную гладкость $C^2$.