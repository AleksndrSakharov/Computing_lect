```
Правило Рунге. Апостериорная оценка погрешности (метод двойного пересчета на сетках с шагом h и h/2), контроль фактического порядка сходимости.
```
**2. Правило Рунге (Апостериорная оценка)**
Позволяет оценить ошибку, имея результаты вычислений на двух сетках: с шагом $h$ ($I_h$) и с шагом $h/2$ ($I_{h/2}$).
Предполагая, что главная часть погрешности имеет вид $C \cdot h^p$ (где $p$ — порядок метода), получаем:
$$R_{h/2} \approx \frac{I_{h/2} - I_h}{2^p - 1}$$
Это значение добавляют к $I_{h/2}$ для уточнения результата (Рунге-Ромберг).
Также можно контролировать реальный порядок сходимости: $p^* = \log_2 \frac{I_{h} - I_{h/2}}{I_{h/2} - I_{h/4}}$.

---
---
## Вывод формулы оценки погрешности:

Пусть $I^*$ — точное значение интеграла, $I_h$ и $I_{h/2}$ — приближения на сетках с шагами $h$ и $h/2$, полученные по формуле порядка $p$. Тогда:
$$
I^* = I_h + ch^p + o(h^p), \quad I^* = I_{h/2} + c \left( \frac{h}{2} \right)^p + o(h^p).
$$
Вычитая первое равенство из второго, получаем:
$$
I_{h/2} - I_h = ch^p - c \frac{h^p}{2^p} + o(h^p) = ch^p \left( 1 - \frac{1}{2^p} \right) + o(h^p).
$$
Отсюда главный член погрешности для мелкой сетки:
$$
c \left( \frac{h}{2} \right)^p \approx \frac{I_{h/2} - I_h}{2^p - 1}.
$$
Эта величина и принимается за оценку $\epsilon_{h/2}$.

---
## Апостериорная оценка погрешности (метод двойного пересчета):

Пусть $I_h$ и $I_{h/2}$ — приближённые значения интеграла, вычисленные по квадратурной формуле порядка $p$ на сетках с шагами $h$ и $h/2$ соответственно.

Оценка главного члена погрешности на мелкой сетке:
$$
\epsilon_{h/2} \approx \frac{I_{h/2} - I_h}{2^p - 1}
$$
**Контроль фактического порядка сходимости:** Следить за выполнением соотношения
$$
p^* \equiv \log_2 \frac{\Delta_h}{\Delta_{h/2}} \approx p,
$$
где $\Delta_h = I_{h/2} - I_h$. Фактический порядок $p^*$ может быть меньше номинального $p$ из-за недостаточной гладкости $f(x)$.