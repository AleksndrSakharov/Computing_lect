```
Метод Монте-Карло (Метод статистических испытаний). Геометрическая интерпретация метода для вычисления определенных интегралов. Оценка погрешности (зависимость от числа испытаний $N$ как $O(1/N)$
```
## 1. Геометрическая интерпретация.  
Пусть требуется вычислить интеграл  
$$
I = \int_{a}^{b} f(x) dx.
$$
Предположим, что $0 \leq f(x) \leq M$ на $[a, b]$. Рассмотрим прямоугольник $R = [a, b] \times [0, M]$. Площадь под графиком $y = f(x)$ равна $I$.

## 2. Алгоритм.
1. Генерируем $N$ независимых случайных точек $(x_i, y_i)$, равномерно распределённых в $R$.
2. Подсчитываем количество точек $K$, для которых $y_i \leq f(x_i)$.
3. Оценка интеграла:
$$
\hat{I} = M(b - a) \cdot \frac{K}{N}.
$$
## 3. Оценка погрешности.

Вероятность попадания случайной точки под график: $p = \frac{I}{M(b - a)}.$
Случайная величина $K$ имеет биномиальное распределение:
$$
\mathbb{E}[K] = Np, \quad \text{Var}(K) = Np(1 - p).
$$
Тогда оценка $\hat{I}$ имеет:
- Математическое ожидание: $\mathbb{E}[\hat{I}] = I$ (несмещённость).
- Дисперсия:
$$
\text{Var}(\hat{I}) = M^2(b - a)^2 \cdot \frac{\text{Var}(K)}{N^2} = M^2(b - a)^2 \cdot \frac{p(1 - p)}{N} = \frac{I(M(b - a) - I)}{N}.
$$
**Среднеквадратическое отклонение:**
$$
\sigma(\hat{I}) = \sqrt{\text{Var}(\hat{I})} = \sqrt{\frac{I(M(b - a) - I)}{N}} \propto \frac{1}{\sqrt{N}}.
$$

Таким образом, погрешность убывает как $O(1/\sqrt{N})$.

## 4. Общий случай (интеграл со знаком).  
Для произвольной $f(x)$ оценка:
$$
\hat{I} = \frac{b - a}{N} \sum_{i=1}^{N} f(x_i),
$$
где $x_i$ — независимые равномерные на $[a, b]$ случайные величины.

Дисперсия:
$$
\text{Var}(\hat{I}) = \frac{(b - a)^2}{N^2} \sum_{i=1}^N \text{Var}(f(x_i)) = \frac{(b - a)^2}{N} \cdot \sigma_f^2,
$$
где
$$
\sigma_f^2 = \frac{1}{b - a} \int_a^b (f(x) - \bar{f})^2 dx, \quad \bar{f} = \frac{1}{b - a} \int_a^b f(x) dx.
$$
Снова получаем:
$$
\sigma(\hat{I}) = \frac{b - a}{\sqrt{N}} \sigma_f \sim O \left( \frac{1}{\sqrt{N}} \right).
$$

## 5. Сравнение с детерминированными методами.

- Для одномерных интегралов методы численного интегрирования (например, Симпсона) дают погрешность $O(N^{-p})$ с $p \geq 2$, что гораздо быстрее, чем $O(N^{-1/2})$.
- В многомерном случае ($d$ измерений) сеточные методы требуют $N = m^d$ точек для достижения погрешности $O(m^{-p}) = O(N^{-p/d})$. При больших $d$ это хуже, чем $O(N^{-1/2})$, что объясняет эффективность Монте-Карло для задач высокой размерности.

---

**Итог:** Метод Монте-Карло обеспечивает сходимость по вероятности со скоростью $O(1/\sqrt{N})$, что медленнее детерминированных методов в малой размерности, но выгодно в высокой размерности благодаря независимости скорости сходимости от размерности.