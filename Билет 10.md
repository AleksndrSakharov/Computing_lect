```
Кубические сплайны. Алгоритм построения через вторые производные (моменты).
```

*Построение:*
Обозначим $M_i = S''(x_i)$. Так как сплайн кубический, вторая производная линейна на отрезке. Выражаем $S''(x)$ через $M_i$ и $M_{i+1}$.
Дважды интегрируем, получаем выражение для $S(x)$ с константами.
Константы находим из условий сшивки первых производных $S'_{i-1}(x_i) = S'_i(x_i)$.
Это приводит к системе уравнений относительно моментов $M_i$:


$$\mu_i M_{i-1} + 2 M_i + \lambda_i M_{i+1} = d_i$$
Матрица системы — трехдиагональная. Решается методом прогонки.
*Граничные условия:* Часто полагают $M_0 = M_n = 0$ (естественный сплайн).

---
---
## 1. Идея метода.

Введём обозначения:
$h_i = x_i - x_{i-1} \quad \text{— шаг сетки}.$
$M_i = S''(x_i) \quad \text{— момент (вторая производная сплайна в узле)}.$
На каждом отрезке $S_i(x)$ — кубический полином, поэтому $S_i''(x)$ — линейная функция.

## 2. Выражение сплайна через моменты.

Из линейности $S_i''(x)$ и условий $S_i''(x_{i-1}) = M_{i-1}$, $S_i''(x_i) = M_i$ получаем:
$$
S_i''(x) = M_{i-1} \frac{x_i - x}{h_i} + M_i \frac{x - x_{i-1}}{h_i}.
$$
Интегрируем дважды:
$$
S_i'(x) = -M_{i-1} \frac{(x_i - x)^2}{2h_i} + M_i \frac{(x - x_{i-1})^2}{2h_i} + A_i,
$$
$$
S_i(x) = M_{i-1} \frac{(x_i - x)^3}{6h_i} + M_i \frac{(x - x_{i-1})^3}{6h_i} + A_i(x - x_{i-1}) + B_i,
$$
где $A_i$, $B_i$ — константы интегрирования.

## 3. Определение констант из условий интерполяции.

Из $S_i(x_{i-1}) = f_{i-1}$ и $S_i(x_i) = f_i$ находим:
$$
B_i = f_{i-1}, \quad A_i = \frac{f_i - f_{i-1}}{h_i} - \frac{h_i}{6}(M_i - M_{i-1}).
$$

## 4. Условие непрерывности первой производной.

Внутренний узел $x_i: S_i'(x_i) = S_{i+1}'(x_i)$. После подстановки выражений для $S_i'$ и $S_{i+1}'$ получаем уравнение для моментов:
$$
\frac{h_i}{6}M_{i-1} + \frac{h_i + h_{i+1}}{3}M_i + \frac{h_{i+1}}{6}M_{i+1} = \frac{f_{i+1} - f_i}{h_{i+1}} - \frac{f_i - f_{i-1}}{h_i}, \quad i = 1, \ldots, n-1.
$$

Это **трёхдиагональная система** из $n - 1$ уравнений относительно $n + 1$ неизвестных $M_0, M_1, \ldots, M_n.$

## 5. Замыкание системы граничными условиями.

- **Естественный сплайн:** $M_0 = 0$, $M_n = 0$.
- **С заданными первыми производными:** используют условия $S'(x_0) = f_0'$, $S'(x_n) = f_n'$, которые приводят к уравнениям, связывающим $M_0, M_1$ и $M_{n-1}, M_n$.

## 6. Алгоритм построения.

1. Задать граничные условия → получить замкнутую трёхдиагональную систему на $M_i$.
2. Решить её методом прогонки.
3. По найденным $M_i$ вычислить коэффициенты $A_i, B_i$ для каждого отрезка.
4. Записать кубический полином $S_i(x)$ на каждом отрезке.