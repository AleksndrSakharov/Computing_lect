```
Метод наименьших квадратов (МНК). Постановка задачи аппроксимации, критерий минимизации ошибки, вывод системы нормальных уравнений (на примере линейной зависимости).
```
**1. Метод наименьших квадратов (МНК)**
Применяется, когда нужно приблизить облако точек некоторой гладкой функцией (например, прямой $y=ax+b$), не проходящей строго через точки, но минимизирующей общую ошибку.
Критерий качества:
$$J = \sum_{i=1}^n (y_i - (ax_i + b))^2 \to \min$$
Для минимизации берем частные производные по $a$ и $b$ и приравниваем к нулю: $\frac{\partial J}{\partial a} = 0, \frac{\partial J}{\partial b} = 0$.
Это приводит к системе линейных уравнений (СЛАУ) относительно $a$ и $b$, которая называется системой нормальных уравнений. Определитель этой системы (определитель Грама) отличен от нуля (если точки различны), решение единственно.

---
---
## 1. Постановка задачи.

Даны:

- Таблица экспериментальных данных: $(x_i, y_i), \, i = 1, \ldots, m$.
- Задана система базисных функций $\varphi_0(x), \varphi_1(x), \ldots, \varphi_n(x)$ (например, степени $x$, синусы и т.д.).

Требуется найти коэффициенты $a_0, a_1, \ldots, a_n$ такие, чтобы функция

$$
\Phi(x; \mathbf{a}) = a_0 \varphi_0(x) + a_1 \varphi_1(x) + \cdots + a_n \varphi_n(x)
$$

наилучшим образом приближала данные в смысле метода наименьших квадратов.

## 2. Критерий минимизации ошибки.

Вводится функционал невязки — сумма квадратов отклонений в узлах:

$$
S(a_0, \ldots, a_n) = \sum_{i=1}^m [\Phi(x_i; \mathbf{a}) - y_i]^2.
$$

Задача: найти $\mathbf{a}$, доставляющие минимум $S(\mathbf{a})$.

## 3. Вывод системы нормальных уравнений (на примере линейной зависимости).

Частный случай: линейная аппроксимация $\Phi(x; a, b) = a + bx$ (здесь $\varphi_0(x) = 1$, $\varphi_1(x) = x$).

Тогда  
$$
S(a, b) = \sum_{i=1}^m (a + bx_i - y_i)^2.
$$

Необходимое условие экстремума: частные производные равны нулю:  
$$
\begin{cases} 
\frac{\partial S}{\partial a} = 2\sum_{i=1}^m (a + bx_i - y_i) \cdot 1 = 0, \\ 
\frac{\partial S}{\partial b} = 2\sum_{i=1}^m (a + bx_i - y_i) \cdot x_i = 0.
\end{cases}
$$

После деления на 2 и раскрытия сумм получаем систему нормальных уравнений:  
$$
\begin{cases} 
ma + b\sum x_i = \sum y_i, \\ 
a\sum x_i + b\sum x_i^2 = \sum x_i y_i.
\end{cases}
$$

## 4. Общий случай.

Для базиса $\{\varphi_j(x)\}_{j=0}^n$ функционал:

$$
S(\mathbf{a}) = \sum_{i=1}^m \left[ \sum_{j=0}^n a_j \varphi_j(x_i) - y_i \right]^2.
$$

Условие минимума: $\frac{\partial S}{\partial a_k} = 0 \quad \text{для всех } k = 0, \ldots, n.$

Вычисляем:

$$
\frac{\partial S}{\partial a_k} = 2 \sum_{i=1}^m \left[ \sum_{j=0}^n a_j \varphi_j(x_i) - y_i \right] \varphi_k(x_i) = 0.
$$

Перегруппируем:

$$
\sum_{j=0}^n a_j \sum_{i=1}^m \varphi_j(x_i) \varphi_k(x_i) = \sum_{i=1}^m y_i \varphi_k(x_i), \quad k = 0, \ldots, n.
$$

В матричной форме:

$$
G\mathbf{a} = \mathbf{b},
$$

где  $G_{kj} = \sum_{i=1}^m \varphi_j(x_i) \varphi_k(x_i) \quad \text{— матрица Грама системы функций } \{\varphi_j\} \text{ на множестве узлов } \{x_i\},$
$b_k = \sum_{i=1}^m y_i \varphi_k(x_i) \quad \text{— вектор правой части}.$

Эта система называется **системой нормальных уравнений МНК**.